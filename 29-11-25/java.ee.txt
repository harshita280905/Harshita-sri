First Web Page

sql code

CREATE DATABASE test;
USE test;

CREATE TABLE members (
  id int AUTO_INCREMENT PRIMARY KEY,
  first_name varchar(45),
  last_name varchar(45),
  email varchar(45),
  uname varchar(45),
  pass varchar(45),
  regdate date
);
select*from members;
-------------------------------------------------------------------------------
index.jsp

<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>JSP Example</title>
</head>
<body>
<form method="post" action="login.jsp">
<center>
<table border="1" width="30%" cellpadding="3">
<thead>
<tr>
<th colspan="2">Login Here</th>
</tr>
</thead>
<tbody>
<tr>
<td>User Name</td>
<td><input type="text" name="uname" value="" /></td>
</tr>
<tr>
<td>Password</td>
<td><input type="password" name="pass" value="" /></td>
</tr>
<tr>
<td><input type="submit" value="Login" /></td>
<td><input type="reset" value="Reset" /></td>
</tr>
<tr>
<td colspan="2">Yet Not Registered!! <a href="reg.jsp">Register Here</a></td>
</tr>
</tbody>
</table>
</center>
</form>
</body>
</html>
-------------------------------------------------------------------------------------
login.jsp

<%@ page import ="java.sql.*" %>
<%
String userid = request.getParameter("uname");    
String pwd = request.getParameter("pass");
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/test",
"root", "root");
Statement st = con.createStatement();
ResultSet rs;
rs = st.executeQuery("select * from members where uname='" + userid + "' and pass='" + pwd + "'");
if (rs.next()) {
session.setAttribute("userid", userid);
//out.println("welcome " + userid);
//out.println("<a href='logout.jsp'>Log out</a>");
response.sendRedirect("success.jsp");
} else {
out.println("Invalid password <a href='index.jsp'>try again</a>");
}
%>
--------------------------------------------------------------------------------------
logout.jsp

<%
session.setAttribute("userid", null);
session.invalidate();
response.sendRedirect("index.jsp");
%>
-----------------------------------------------------------------------------------------
reg.jsp

<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Registration</title>
</head>
<body>
<form method="post" action="registration.jsp">
<center>
<table border="1" width="30%" cellpadding="5">
<thead>
<tr>
<th colspan="2">Enter Information Here</th>
</tr>
</thead>
<tbody>
<tr>
<td>First Name</td>
<td><input type="text" name="fname" value="" /></td>
</tr>
<tr>
<td>Last Name</td>
<td><input type="text" name="lname" value="" /></td>
</tr>
<tr>
<td>Email</td>
<td><input type="text" name="email" value="" /></td>
</tr>
<tr>
<td>User Name</td>
<td><input type="text" name="uname" value="" /></td>
</tr>
<tr>
<td>Password</td>
<td><input type="password" name="pass" value="" /></td>
</tr>
<tr>
<td><input type="submit" value="Submit" /></td>
<td><input type="reset" value="Reset" /></td>
</tr>
<tr>
<td colspan="2">Already registered!! <a href="index.jsp">Login Here</a></td>
</tr>
</tbody>
</table>
</center>
</form>
</body>
</html>
-------------------------------------------------------------------------------------------------------
registration.jsp

<%@ page import ="java.sql.*" %>
<%
String user = request.getParameter("uname");    
String pwd = request.getParameter("pass");
String fname = request.getParameter("fname");
String lname = request.getParameter("lname");
String email = request.getParameter("email");
Class.forName("com.mysql.jdbc.Driver");
Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/test",
"root", "root");
Statement st = con.createStatement();
//ResultSet rs;
int i = st.executeUpdate("insert into members(first_name, last_name, email, uname, pass, regdate) values ('" + fname + "','" + lname + "','" + email + "','" + user + "','" + pwd + "', CURDATE())");
if (i > 0) {
//session.setAttribute("userid", user);
response.sendRedirect("welcome.jsp");
// out.print("Registration Successfull!"+"<a href='index.jsp'>Go to Login</a>");
} else {
response.sendRedirect("index.jsp");
}
%>
-------------------------------------------------------------------------------------
success.jsp

<%
if ((session.getAttribute("userid") == null) || (session.getAttribute("userid") == "")) {
%>
You are not logged in<br/>
<a href="index.jsp">Please Login</a>
<%} else {
%>
Welcome <%=session.getAttribute("userid")%>
<a href='logout.jsp'>Log out</a>
<%
}
%>
--------------------------------------------------------------------------------------
welcome.jsp

Registration is Successful.
Please Login Here <a href='index.jsp'>Go to Login</a>
---------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
JSPCRUD

sql code

CREATE DATABASE IF NOT EXISTS test1;
USE test1;
CREATE TABLE IF NOT EXISTS register (
    id INT(10) NOT NULL AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    password VARCHAR(100) NOT NULL,
    email VARCHAR(100) NOT NULL,
    sex VARCHAR(50) NOT NULL,
    country VARCHAR(100) NOT NULL,
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
INSERT INTO register (name, password, email, sex, country) VALUES
('Arun', 'kumar', 'arun@gmail.com', 'Male', 'India'),
('Sonoo', 'jaiswal', 'sonoo@javatpoint.com', 'Male', 'India'),
('Ashok', 'ashok', 'ashok@javatpoint.com', 'Male', 'India');
SELECT * FROM register;
------------------------------------------------------------------------------------------------
adduser-error.jsp

<!DOCTYPE html>  
<html>  
<head>  
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">  
<title>Add User Error</title>  
</head>  
<body>  
  
<p>Sorry, an error occurred!</p>  
<jsp:include page="userform.html"></jsp:include>  
  
</body>  
</html>  
-----------------------------------------------------------------------------------
adduser-success.jsp

<!DOCTYPE html>  
<html>  
<head>  
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">  
<title>Add User Success</title>  
</head>  
<body>  
  
<p>Record successfully saved!</p>  
<jsp:include page="userform.html"></jsp:include>  
  
</body>  
</html>  
------------------------------------------------------------------------------------
adduser.jsp

<%@ page import="com.javatpoint.dao.UserDao" %>
<jsp:useBean id="u" class="com.javatpoint.bean.User" />
<jsp:setProperty property="*" name="u" />

<%
    int i = UserDao.save(u);
    if(i > 0){
        response.sendRedirect("adduser-success.jsp");
    } else {
        response.sendRedirect("adduser-error.jsp");
    }
%>
-----------------------------------------------------------------------------------------
adduserform.jsp

<!DOCTYPE html>  
<html>  
<head>  
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">  
<title>Add User Form</title>  
</head>  
<body>  
  
<jsp:include page="userform.html"></jsp:include>  
  
</body>  
</html> 
-------------------------------------------------------------------------------------
deleteuser.jsp

<%@page import="com.javatpoint.dao.UserDao"%>  
<jsp:useBean id="u" class="com.javatpoint.bean.User"></jsp:useBean>  
<jsp:setProperty property="*" name="u"/>  
<%  
UserDao.delete(u);  
response.sendRedirect("viewusers.jsp");  
%>  
---------------------------------------------------------------------------------
editform.jsp

<%@ page import="com.javatpoint.dao.UserDao,com.javatpoint.bean.User" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Edit Form</title>
</head>
<body>

<%
    String id = request.getParameter("id");
    User u = UserDao.getRecordById(Integer.parseInt(id));
%>

<h1>Edit User</h1>

<form action="edituser.jsp" method="post">
<input type="hidden" name="id" value="<%= u.getId() %>"/>

<table>
<tr>
    <td>Name:</td>
    <td><input type="text" name="name" value="<%= u.getName() %>" required/></td>
</tr>

<tr>
    <td>Password:</td>
    <td><input type="password" name="password" value="<%= u.getPassword() %>" required/></td>
</tr>

<tr>
    <td>Email:</td>
    <td><input type="email" name="email" value="<%= u.getEmail() %>" required/></td>
</tr>

<tr>
    <td>Sex:</td>
    <td>
        <input type="radio" name="sex" value="male" <%= u.getSex().equals("male") ? "checked" : "" %>/> Male
        <input type="radio" name="sex" value="female" <%= u.getSex().equals("female") ? "checked" : "" %>/> Female
    </td>
</tr>

<tr>
    <td>Country:</td>
    <td>
        <select name="country">
            <option <%= u.getCountry().equals("India") ? "selected" : "" %> >India</option>
            <option <%= u.getCountry().equals("Pakistan") ? "selected" : "" %> >Pakistan</option>
            <option <%= u.getCountry().equals("Afghanistan") ? "selected" : "" %> >Afghanistan</option>
            <option <%= u.getCountry().equals("Berma") ? "selected" : "" %> >Berma</option>
            <option <%= u.getCountry().equals("Other") ? "selected" : "" %> >Other</option>
        </select>
    </td>
</tr>

<tr>
    <td colspan="2"><input type="submit" value="Update User"/></td>
</tr>
</table>
</form>

</body>
</html>
----------------------------------------------------------------------------------
edituser.jsp

<%@ page import="com.javatpoint.dao.UserDao" %>
<jsp:useBean id="u" class="com.javatpoint.bean.User" />
<jsp:setProperty property="*" name="u" />

<%
    int i = UserDao.update(u);
    response.sendRedirect("viewusers.jsp");
%>
  
--------------------------------------------------------------------------------
index.jsp

<!DOCTYPE html>  
<html>  
<head>  
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">  
<title>JSP CRUD Example</title>  
</head>  
<body>  
<h1>JSP CRUD Example</h1>  
<a href="adduserform.jsp">Add User</a>  
<a href="viewusers.jsp">View Users</a>  
  
</body>  
</html>  
--------------------------------------------------------------------------------
userform.html

<a href="viewusers.jsp">View All Records</a><br/>  
  
<h1>Add New User</h1>  
<form action="adduser.jsp" method="post">  
<table>  
<tr><td>Name:</td><td><input type="text" name="name"/></td></tr>  
<tr><td>Password:</td><td>  
<input type="password" name="password"/></td></tr>  
<tr><td>Email:</td><td><input type="email" name="email"/></td></tr>  
<tr><td>Sex:</td><td>  
<input type="radio" name="sex" value="male"/>Male   
<input type="radio" name="sex" value="female"/>Female </td></tr>  
<tr><td>Country:</td><td>  
<select name="country" style="width:155px">  
<option>India</option>  
<option>Pakistan</option>  
<option>Afghanistan</option>  
<option>Berma</option>  
<option>Other</option>  
</select>  
</td></tr>  
<tr><td colspan="2"><input type="submit" value="Add User"/></td></tr>  
</table>  
</form>  
---------------------------------------------------------------------------
viewusers.jsp

<%@ page import="com.javatpoint.dao.UserDao,com.javatpoint.bean.User,java.util.List" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>View Users</title>
</head>
<body>

<h1>User List</h1>

<%
    List<User> list = UserDao.getAllRecords();
    request.setAttribute("list", list);
%>

<table border="1" width="90%">
    <tr>
        <th>Id</th>
        <th>Name</th>
        <th>Password</th>
        <th>Email</th>
        <th>Sex</th>
        <th>Country</th>
        <th>Edit</th>
        <th>Delete</th>
    </tr>

    <c:forEach items="${list}" var="u">
        <tr>
            <td>${u.id}</td>
            <td>${u.name}</td>
            <td>${u.password}</td>
            <td>${u.email}</td>
            <td>${u.sex}</td>
            <td>${u.country}</td>
            <td><a href="editform.jsp?id=${u.id}">Edit</a></td>
            <td><a href="deleteuser.jsp?id=${u.id}" onclick="return confirm('Are you sure?');">Delete</a></td>
        </tr>
    </c:forEach>
</table>

<br>
<a href="adduserform.jsp">Add New User</a>

</body>
</html>
 
----------------------------------------------------------------------------------------
user.java

package com.javatpoint.bean;  
public class User {  
private int id;  
private String name,password,email,sex,country;
public int getId() {
	return id;
}
public void setId(int id) {
	this.id = id;
}
public String getName() {
	return name;
}
public void setName(String name) {
	this.name = name;
}
public String getPassword() {
	return password;
}
public void setPassword(String password) {
	this.password = password;
}
public String getEmail() {
	return email;
}
public void setEmail(String email) {
	this.email = email;
}
public String getSex() {
	return sex;
}
public void setSex(String sex) {
	this.sex = sex;
}
public String getCountry() {
	return country;
}
public void setCountry(String country) {
	this.country = country;
}  

}  
------------------------------------------------------------------------------
userdao.java

package com.javatpoint.dao;  
import java.sql.*;  
import java.util.ArrayList;  
import java.util.List;  
import com.javatpoint.bean.User;  
public class UserDao {  
  
public static Connection getConnection(){  
    Connection con=null;  
    try{  
        Class.forName("com.mysql.jdbc.Driver");  
        con=DriverManager.getConnection("jdbc:mysql://localhost:3306/test1","root","root");  
    }catch(Exception e){System.out.println(e);}  
    return con;  
}  
public static int save(User u){  
    int status=0;  
    try{  
        Connection con=getConnection();  
        PreparedStatement ps=con.prepareStatement(  
"insert into register(name,password,email,sex,country) values(?,?,?,?,?)");  
        ps.setString(1,u.getName());  
        ps.setString(2,u.getPassword());  
        ps.setString(3,u.getEmail());  
        ps.setString(4,u.getSex());  
        ps.setString(5,u.getCountry());  
        status=ps.executeUpdate();  
    }catch(Exception e){System.out.println(e);}  
    return status;  
}  
public static int update(User u){  
    int status=0;  
    try{  
        Connection con=getConnection();  
        PreparedStatement ps=con.prepareStatement(  
"update register set name=?,password=?,email=?,sex=?,country=? where id=?");  
        ps.setString(1,u.getName());  
        ps.setString(2,u.getPassword());  
        ps.setString(3,u.getEmail());  
        ps.setString(4,u.getSex());  
        ps.setString(5,u.getCountry());  
        ps.setInt(6,u.getId());  
        status=ps.executeUpdate();  
    }catch(Exception e){System.out.println(e);}  
    return status;  
}  
public static int delete(User u){  
    int status=0;  
    try{  
        Connection con=getConnection();  
        PreparedStatement ps=con.prepareStatement("delete from register where id=?");  
        ps.setInt(1,u.getId());  
        status=ps.executeUpdate();  
    }catch(Exception e){System.out.println(e);}  
  
    return status;  
}  
public static List<User> getAllRecords(){  
    List<User> list=new ArrayList<User>();  
      
    try{  
        Connection con=getConnection();  
        PreparedStatement ps=con.prepareStatement("select * from register");  
        ResultSet rs=ps.executeQuery();  
        while(rs.next()){  
            User u=new User();  
            u.setId(rs.getInt("id"));  
            u.setName(rs.getString("name"));  
            u.setPassword(rs.getString("password"));  
            u.setEmail(rs.getString("email"));  
            u.setSex(rs.getString("sex"));  
            u.setCountry(rs.getString("country"));  
            list.add(u);  
        }  
    }catch(Exception e){System.out.println(e);}  
    return list;  
}  
public static User getRecordById(int id){  
    User u=null;  
    try{  
        Connection con=getConnection();  
        PreparedStatement ps=con.prepareStatement("select * from register where id=?");  
        ps.setInt(1,id);  
        ResultSet rs=ps.executeQuery();  
        while(rs.next()){  
            u=new User();  
            u.setId(rs.getInt("id"));  
            u.setName(rs.getString("name"));  
            u.setPassword(rs.getString("password"));  
            u.setEmail(rs.getString("email"));  
            u.setSex(rs.getString("sex"));  
            u.setCountry(rs.getString("country"));  
        }  
    }catch(Exception e){System.out.println(e);}  
    return u;  
}  
}  
